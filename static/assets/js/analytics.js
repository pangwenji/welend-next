function analyticsInit(t){"use strict";var e=t.ahoyUrl;if(e){var i,n,r,o,a=e+"/t/visits",c=e+"/t/events",s=window.jQuery||window.Zepto||window.$,u=!1,d=[],f="undefined"!=typeof JSON&&void 0!==JSON.stringify,h=[],g=t.page||window.location.pathname;if(i=w("ahoy_visit"),n=w("ahoy_visitor"),r=w("user_id"),o=w("ahoy_track"),i&&n&&!o)x("ahoy_visit",i,30),k("Active visit"),p();else if(o&&y("ahoy_track"),i||x("ahoy_visit",i=m(),30),w("ahoy_visit")){k("Visit started"),n||x("ahoy_visitor",n=m(),1051200);var l={visit_token:i,visitor_token:n,user_id:window.tracker_id||r,platform:t.platform||"Web",landing_page:window.location.href,screen_width:window.screen.width,screen_height:window.screen.height};document.referrer.length>0&&(l.referrer=document.referrer),k(l),s.post(a,l,p,"json")}else k("Cookies disabled"),p();t.getVisitId=t.getVisitToken=function(){return i},t.getVisitorId=t.getVisitorToken=function(){return n},t.getUserId=t.getUserToken=function(){return window.tracker_id||r},t.reset=function(){return y("ahoy_visit"),y("ahoy_visitor"),y("ahoy_events"),y("ahoy_track"),!0},t.debug=function(t){return!1===t?y("ahoy_debug"):x("ahoy_debug","t",525600),!0},t.track=function(t,e){var n={id:m(),visit_token:i,name:t,properties:e,time:(new Date).getTime()/1e3};k(n),h.push(n),_(),setTimeout(function(){b(n)},1e3)},t.trackView=function(){var e={url:window.location.href,title:document.title,page:g};t.track("$view",e)},t.trackClicks=function(){s(document).on("click","a, button, input[type=submit]",function(e){var i=s(e.currentTarget),n=T(e);n.text="input"==n.tag?i.val():s.trim(i.text().replace(/[\s\r\n]+/g," ")),n.href=i.attr("href"),t.track("$click",n)})},t.trackSubmits=function(){s(document).on("submit","form",function(e){var i=T(e);t.track("$submit",i)})},t.trackChanges=function(){s(document).on("change","input, textarea, select",function(e){var i=T(e);t.track("$change",i)})},t.trackAll=function(){t.trackView(),t.trackClicks(),t.trackSubmits(),t.trackChanges()};try{h=JSON.parse(w("ahoy_events")||"[]")}catch(t){}for(var v=0;v<h.length;v++)b(h[v]);window.ahoy=t}function x(e,i,n){var r="",o="";if(n){var a=new Date;a.setTime(a.getTime()+60*n*1e3),r="; expires="+a.toGMTString()}t.domain&&(o="; domain="+t.domain),document.cookie=e+"="+escape(i)+r+o+"; path=/"}function w(t){var e,i,n=t+"=",r=document.cookie.split(";");for(e=0;e<r.length;e++){for(i=r[e];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(n))return unescape(i.substring(n.length,i.length))}return null}function y(t){x(t,"",-1)}function k(t){w("ahoy_debug")&&window.console.log(t)}function p(){for(var t;t=d.shift();)t();u=!0}function m(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})}function _(){f&&x("ahoy_events",JSON.stringify(h),1)}function b(t){var e;e=function(){f&&s.ajax({type:"POST",url:c,data:JSON.stringify([t]),contentType:"application/json; charset=utf-8",dataType:"json",headers:{"Ahoy-User":window.tracker_id||r,"Ahoy-Visit":i,"Ahoy-Visitor":n},success:function(){for(var e=0;e<h.length;e++)if(h[e].id==t.id){h.splice(e,1);break}_()}})},u?e():d.push(e)}function T(t){var e=s(t.currentTarget);return{url:window.location.href,tag:e.get(0).tagName.toLowerCase(),id:e.attr("id"),class:e.attr("class"),page:g,section:e.closest("*[data-section]").data("section")}}}